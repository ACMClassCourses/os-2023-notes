### IPC

- inter-process communication

1. PA sends data to PB   pipe()
2. PB wait data from PA  signal
3. PA race with PB     race condition



critical region



```
while (lock == 1);
lock = 0
...
lock = 1
```

the code above is not correct under the circumstance of multi-threading



- TSL (test and set lock)  
  - atomic
  - solved race condition among single core
- lock Bus (multi-thread)



### Mutual Exclusion

1. CLI (clear/clean interruption) 

   ∵ no INT  ∴ no schedule, no others   (**dangerous**)

2. Busy wait (strict AH, Peterson)

3. sleep / wait

   - producer-consumer problem:

     reason: 

     ```
     if (count == N) sleep(consumer)
     ```

     isn't atomic.

   - solution: semaphone (syscall)

     cons: meet problems when kernel is not atomic



- reentrant (可重入): 